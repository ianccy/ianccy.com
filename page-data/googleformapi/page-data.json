{"componentChunkName":"component---src-templates-post-tsx","path":"/googleformapi/","result":{"data":{"site":{"siteMetadata":{"title":"Ian Chu"}},"markdownRemark":{"id":"c871f0be-23f9-50ed-a01a-4ca0dc585bcd","excerpt":"要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾…其實我對 google 表單設定不太熟悉)。 或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google…","html":"<p>要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾…其實我對 google 表單設定不太熟悉)。</p>\n<p>或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google form 的 iframe 又無法追蹤填表操作動作，google analytics 轉換目標也不能設定。上面這些問題都可以用 google excel 的 api 來解決。</p>\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"炸雞訂購網頁\">炸雞訂購網頁</a></p>\n<ul>\n<li>延伸文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>\n<h2>google excel 試算表 實作功能</h2>\n<p>這邊要利用 google 試算表 增加資料 撈取 來實作一個網頁，簡單的鹹酥雞訂餐服務，老闆也可以修改處理狀態，讓顧客可以再取餐前查詢，到底老闆有沒有幫我做好鹹酥雞勒，還是放生我了 XD。</p>\n<p>只需要搭配 html + css + javascript。\n（因為我家附近有間鹹酥雞，每次買都實在等太久，所以才想玩玩看。）</p>\n<h2>google sheet method 介紹</h2>\n<p>google 官方文件 <a href=\"https://developers.google.com/apps-script/reference/spreadsheet/sheet\" title=\"google sheet api\">spreadsheet method</a>，裡面有非常詳盡的介紹，包括可以讀取欄位、讀取資料、排序資料、插入資料等等的功能，其實某方面來說算是功能齊全的類資料庫了。有興趣可以點開來看裡面文件。</p>\n<p>文件裡面 method 一大堆，還是直接實作比較快。</p>\n<h3>STEP.1 打開 google 雲端硬碟 建立 google excel、建立 google AppScript</h3>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 358px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.51396648044692%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsTAAALEwEAmpwYAAACRUlEQVQ4y42Ty27UMBSG82K8AmLDGgmJLUuWLNiDxA7Eig0IseAJ2M7QpkXttFVGylzSuHGcSeIktnPz5RhNQ0ctnUZ88saWf5/zH/12RAusgYxDWQNvoVf2/3GevKsfv61ffe2efWgevRFfJtJaq82dSwBgrS2KYr1eRxiv1+sgCJbLpfPik3j+kb/+Xr/8LJ6+Zz/czlpQGgzcWWCtqGsSx3mekyQhhGCMnbZTGqzooFNgwBrY1tnL7V7KqirL0rFg3cPDGEecs9npaRheaq0fMjk8AQBZluV57hgDaZqxikulKsaapvmnyN4nKKXbykqpvu/NNUopY4yUEkYxxgghmqZxrLVHR0dBEHDOXdeNomixWIwXB4AkSRhjDgBcXV0VRaGUyvO8qqqmaeq6Hhd7nhdFkWMtTH8dhCFirDo5OUEIBUEQhuFuPHvFxmyTsPV8vTe7m7uRjnj2fZ8Q4hijD5cqLkF2TZIkaZpmWUYIGbENAAihoigcMPrAtxG1WrWEJAihqqoopeOeh34do81P/PtSJKqTyU3u5vM5IWRE3LbtVix7OY08VG1k16dpGscxpRRjnGWZ1lrto+/7ZhBv0lQG3wQ5vkTJ+fnZbDZzXXcymZRlmT9Amqac862YMS7ovGZxWXFCYozxZrOJ41gIUT8A53wIgrP7BpRSz/P6vh8ZlZRSaw0AXdfdEWutx5W3I/BXPJ1Ofd9fLBazs7OLi4vVarW+x2q1QgjhG6IoEkPbu2AMw8juMZy3bWuM0TcMLfwBJ/KskH58DfsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/35b3f7302494a9e625af0ff159a6be5a/ed958/creatExcel.webp 358w\"\n              sizes=\"(max-width: 358px) 100vw, 358px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png 358w\"\n            sizes=\"(max-width: 358px) 100vw, 358px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png\"\n            alt=\"google creatExcel\"\n            title=\"google creatExcel\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">google creatExcel</figcaption>\n  </figure></p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 679px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.47474747474747%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzklEQVQ4y32TUY7bIBCGff9DrKqVeo5VteoR+pAo6q7jGDDYwIzBBAimtUm2TtTd78HCsr+Z3wOunl/j95/h+TWMbs45z8sle+8BQGsNGmKMOGLf9wCQ76meXuy3H9PTi9X2kvOc0lxkxEVgjI3jKIQghAgh3D1VCmBxiJMKZ/dQ2DmntZZSaq0Rsay3VKOxSoGUy+Oc56LNa3prLQD4lfOKv6eSUrZtwznvus57v5URUSmVP6cy9mxsdG6y1sYYtzIASCm/kim439KDHChja/J/eO9DCF/JynTCNAjjsTk+9Ikxlgifym4UHklLGeedtTaEUMYzTZNz7pLmQkq31ea2IpQx3td1rZQaNnDOQUN3tCMaxmjf99ueKaUYY8XY0pMLzgUXhV5Ya906w1i/WURKKWNs+wlXeb/fU0qFEMaY8UZKKed8icG9L3LHOSFkGIaPjbh17ljf9+UYLYcZABGL7L0/vI9S6rZtCSFSynjDe7/IQgi+UkrgSpHtZH+9qROh+/2uro+EkHJOEREAQgjVbrdrmuZwOFBKjTFbOcSAxpSf5GHDr7FL1JL2gyLHGFNKANB13el02g78KuP/KPL57EpppdQ6D71956/8B0wpzzAU/CjUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/14beed9086b4efadb2e23834ac3e6748/a805d/creatAppScript.webp 495w,\n/static/14beed9086b4efadb2e23834ac3e6748/f4cab/creatAppScript.webp 679w\"\n              sizes=\"(max-width: 679px) 100vw, 679px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/14beed9086b4efadb2e23834ac3e6748/b3db0/creatAppScript.png 495w,\n/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png 679w\"\n            sizes=\"(max-width: 679px) 100vw, 679px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png\"\n            alt=\"google creatAppScript\"\n            title=\"google creatAppScript\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">google creatAppScript</figcaption>\n  </figure></p>\n<h3>STEP.2 選擇剛剛創立的 google excel 網址參數</h3>\n<p>xxxxxxxxxxx/edit，/edit 前面這段參數\n<a href=\"https://docs.google.com...\">https://docs.google.com…</a><mark>1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c1</mark>/edit#gid=0</p>\n<h3>STEP.3 打開 AppScript 加上剛剛複製的編碼 以及 javascript</h3>\n<p>首先在 myFunction 上加入參數，因為之後要透過 call 這個 api 帶入資料，下面是預期會帶入的物件名稱 name、phone、time、order、price。這些都可以根據你想要帶的資料名稱變化，也可以刪減。</p>\n<p>後面是依靠 google sheet 的 method 來選取表單，後面貼上你剛剛 excel 的編碼，再來是用.getSheets()[0]來選取第 1 個工作表單。這樣就成功的選取到這整個 table 了。</p>\n<p>這邊先處理接到值傳進來先命名，再來選取你要填入的 google excel 編碼、excel tab。</p>\n<p>ps.這邊用的是 doGet function，代表這個 function 會被 api 的 Get 調用到，也可以用 doPost，但是你串接 api 就要改用 Post。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">doGet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//接帶入值 轉為變數    - 可根據需求修改</span>\n  <span class=\"token keyword\">var</span> params <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>parameter<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> phone <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> time <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> order <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> price <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//這是選擇這個google excel</span>\n  <span class=\"token keyword\">var</span> SpreadSheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">openById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"貼上你剛剛複製的編碼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//取得 第一個表單</span>\n  <span class=\"token keyword\">var</span> Sheet <span class=\"token operator\">=</span> SpreadSheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>這邊比較搞剛的是要處理訂單編號，以便於日後我們比對資料方便，剩下最重要的塞剛剛帶進來的值。就完成的簡單的插入資料 function 了！</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  <span class=\"token operator\">...</span>\n  <span class=\"token comment\">//取得 LastRow = 有資料的最後一行的位置</span>\n  <span class=\"token keyword\">var</span> LastRow <span class=\"token operator\">=</span> Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token comment\">// 這邊是處理訂單編號 - 我先選取 有資料最後一行 的 第6欄</span>\n  <span class=\"token keyword\">var</span> range <span class=\"token operator\">=</span> Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 創立訂單編號  (最後一行的第六欄 +1)</span>\n  <span class=\"token keyword\">var</span> orderNum <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>range<span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//若最後一行是第1行 需要轉為訂單編號1</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>LastRow <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    orderNum <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">//開始寫入資料 同樣是 getRange 選擇 (行,欄) setValue 帶入值name phone time order price values進來</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>phone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>orderNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//寫入結束後傳回true</span>\n  <span class=\"token keyword\">return</span> ContentService<span class=\"token punctuation\">.</span><span class=\"token function\">createTextOutput</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>STEP.4 建立 debug.gs 來測試剛剛的 建立資料</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//call</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> Result <span class=\"token operator\">=</span> <span class=\"token function\">doGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">parameter</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"測試先生\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">phone</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0912345678\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">time</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2018/02/10 22:46:00\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">order</span><span class=\"token operator\">:</span> <span class=\"token string\">\"鹹酥雞 * 1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">price</span><span class=\"token operator\">:</span> <span class=\"token string\">\"40\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Result: %s\"</span><span class=\"token punctuation\">,</span> Result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>STEP.5 編輯 允許權限</h3>\n<p>ㄧ路點選允許到底即可</p>\n<p>這邊需要點進階 前往 xxx 不安全\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 666px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.35353535353536%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNklEQVQ4y5VTTXObMBD1X8+lhx76S9JL20uvbQ89NXEc0jjYxnzJaIUkJISQkIAMkI9pp5mkbxjNMvse2re7rFRJ4+DbJgnyNMuydDqyLM/zXRjebbdBEGw2myRJ5tySnIIlXmUov0t3KZySUxbHSRTFYbiLDhFCCAAwxqfiBEDKkhBCAKAkJQAQQiilK4zxuGAYxrdhmJmc8wfx4NzQdf8lZoytcFGM43j68I5//TIlvB8e8QYxIaO16tNH/fPHG4t/FgOAc66QdYohy9KiKABDHMfHY+y9f0VMCDHGXF9drX9d3N7ehmF4iKL15fryYt0a45zrrO1meO+n165r2/b55q7rMGBGmaxrypgUsmkaXk0gAHiuBTCuVU1piRA6HmNjbVXxh7LrujbWWGu998YYrbUxpus6M8M517atc+4fnr33hECOcgAQUmKMsywrTkVZTvcghDjn+/2eMTZr+2HoH7v9tCSvoe9HoQehh6rp+3HkS8OstYfDIU4Sa+1MmrCMup8fP5GHmLizc/X+c3N2Xn/f+qaeN2wizXhxsPPZ2uF35rfIB6njzVjx2XPf90opWcuSlpRSwCBlrZRijNGypIxRSjEG3ahGECXKRpSTZ/7Y7TRJdvtddDzGcRyGd/v9HiF0E9xsNtdS1kIIzrnWLeMV5xVjfBjmH2MRV5zjCSAqIYR8MPyClz9G1fe91lpKKYTUWiulnhhL8BeWL1ZVtUqSBGOgdHJHKa1EtazKq5Pz3t8Dz4o5zaaui9kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/db5b73795778fac240b89db954ba6cd4/a805d/userright.webp 495w,\n/static/db5b73795778fac240b89db954ba6cd4/e020f/userright.webp 666w\"\n              sizes=\"(max-width: 666px) 100vw, 666px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/db5b73795778fac240b89db954ba6cd4/b3db0/userright.png 495w,\n/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png 666w\"\n            sizes=\"(max-width: 666px) 100vw, 666px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png\"\n            alt=\"google userright\"\n            title=\"google userright\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">google userright</figcaption>\n  </figure>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.13008130081301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA90lEQVQY043Qy27DIBAFUP7/55KdK2GTADZDeIx5BBxHTqjqKFJbddGzuhrp3sWQazSH4+5wTCm11p7PZ/sfYkbGBt51HWjNaB9CVBPM3gkxaqUAQMnJu/nPUeKtmeeAiIwxNrBRjowxUEpKOU2TMab/WgzLsuScU0qllPpGAMDuKKX8TUh5Op1e/a77cN4jonPOGOP3/EIopVpr3E855xijAkV7ygWPMVlrQWvEOV+zcw7Rf0fOZx5C2LZtXddSirF29sEBOoX2YoQUiLje7621x+Ox/UQAdAihLkuttZQCoGupySTFl6G/TYBCcFD6ok0I6dfDPgEUuYdzyxrBBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cdb8a8e4febbe48927197054b4a7758e/39d29/debugRun.webp 492w\"\n              sizes=\"(max-width: 492px) 100vw, 492px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png 492w\"\n            sizes=\"(max-width: 492px) 100vw, 492px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png\"\n            alt=\"debugRun\"\n            title=\"debugRun\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">debugRun</figcaption>\n  </figure></p>\n<h3>STEP.6 部署為網路應用程式</h3>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 633px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.17171717171718%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVQoz32R63KCMBBGef/Hs3WqtBKIkCDkRsgVVtJR2hmt1vN398y3l6zGeLPZ5HkuuAg+jOOoh8E5a40BgPSSrKW063qEECoKhEpCCK7w4euQ7z/b9hRicL+EBzJCCOf8eMSU0qqqGGOUtvvdfvu+3X3sCCHWWecc55wxxu/J6rrWWnvvjTF93xtjrLVKqa7rqrLCGEspvQ8h+LV0S0Zpu46klOKcwwxCiPpYk6Ypy6osS9IQ7zzA+cnOQgjGmLjCuUgpsb4vDgUqCimVs26KU0oJAJYHslWTUl5kwVNKlNCGUNq2p64PMa4hTy//RxYA53EYTgj1TVO+bQcpph/mF7Ja77mGTNbO3k/WXXuWf/98I182995ba2cAiHEBWADidI7PYu/GXl+n9SiEGLV2SkVrIEZtp2F0aXmS/w3ppnNa2CG1zAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0888b33a9fcd9d448463e8151fa0f795/a805d/deployAppScript.webp 495w,\n/static/0888b33a9fcd9d448463e8151fa0f795/3d6ad/deployAppScript.webp 633w\"\n              sizes=\"(max-width: 633px) 100vw, 633px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0888b33a9fcd9d448463e8151fa0f795/b3db0/deployAppScript.png 495w,\n/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png 633w\"\n            sizes=\"(max-width: 633px) 100vw, 633px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png\"\n            alt=\"google deployAppScript\"\n            title=\"google deployAppScript\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">google deployAppScript</figcaption>\n  </figure>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.07070707070707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiElEQVQ4y42Sy27bMBBF8+ld9XO66E/EbZCXjIiSKFEiqUcqywIpMrEeHLKwFSBNzCI+G64O7sxcXtETjDHOOfsI/w9lyVfrilKa57kQAgCMMQBgTwDA4mOaJqUUY6woijdZa+2cSxKcE4JQFIZhlhEA63wsy8IYe0/WWltrHx+DJE7aXdf3vZTSWr8MAJ9l59w2CKqqdl/hka21GOOiYE1da63BhzFmPceHg63JQsh917XPf6ZxdM5ZH/5kAHN3ex8EQRRFJS/hlOBd278zozSOYxSGcRSnGDPGjDGXydYyyrKMJFFMshyFKMvy/b5f5/86mfOSENI0NTv+OV5VFQBcXNX2abt9erh/2Fxvfm1+I4QukpVSzjkzv4IZlRqkHIZhOBwOF/X8+qLEi0O1jRqrRwdmmefZWjdO5rwqY8x7zxnJYdY3ufv2Y/r+cw4rK/u2aZ6XBdr9dF7W5+TdrpWDajvRdkKI49BSSjlIpYZzhBBFUbzJlNI0TTHGaYqPzz8kCfayyn8BeBu2sR+nYBMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/51a32d2ea4472cf10763e6e34553a900/a805d/adjustAppscript.webp 495w,\n/static/51a32d2ea4472cf10763e6e34553a900/1464b/adjustAppscript.webp 562w\"\n              sizes=\"(max-width: 562px) 100vw, 562px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/51a32d2ea4472cf10763e6e34553a900/b3db0/adjustAppscript.png 495w,\n/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png 562w\"\n            sizes=\"(max-width: 562px) 100vw, 562px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png\"\n            alt=\"adjustAppscript\"\n            title=\"adjustAppscript\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">adjustAppscript</figcaption>\n  </figure>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.56565656565656%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABN0lEQVQoz6WQ207CQBRF+f8PMSExfoAxkS8wASzQwlxOO5ROlV7sbXqmM2PwkiBUX1zZryt7nzPhnIdhiIiD1lqj1oiIWuthuIzW2DRNJCLOOXww+ZSdc4ck9bzAW289zyc0HAbjrrDWCiEuZDDWYRsX8qlMF0U6L9J5nXlY+UMTfKXeGBVb68RVM1jrVOnR5U3k37HllCymbHVbJfe6mGH+iPkMs4ehfrZuRA6dtdnxFdhu668AaCyEMTjovuvaXrW96pRqEfvR2aebZSLXaxoE4cYngb/bEQoQxXEi5UuSpELEWV64U/OVbIyp3qpEVvLYx4dsv98DhHlRXDzMGDMiW2vbppHy4Jx1vzMyGwC6rqvruijLtu3UGf1PlFJRdPYwAOCcE0IopYwx+ieEEMYYfDOBf/AOnUVbif4IBOMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6caa881f1c5fbea5f847917154930621/a805d/AppScriptapi.webp 495w,\n/static/6caa881f1c5fbea5f847917154930621/f2984/AppScriptapi.webp 624w\"\n              sizes=\"(max-width: 624px) 100vw, 624px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6caa881f1c5fbea5f847917154930621/b3db0/AppScriptapi.png 495w,\n/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png 624w\"\n            sizes=\"(max-width: 624px) 100vw, 624px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png\"\n            alt=\"AppScriptapi\"\n            title=\"AppScriptapi\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">AppScriptapi</figcaption>\n  </figure></p>\n<p>把上面的 URL 複製起來，這就是我們 API 的 URL。</p>\n<h3>STEP.7 建立 html 串接資料</h3>\n<p>快速簡單的建出了一個網頁，點擊下方的送出，然後 call send function 非同步送出資料，然後成功再回傳給使用者感謝，</p>\n<p>這個頁面的 javasctipt 都在處理 沒填寫資料要被擋，還有組出訂購的品量數量。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">上半部為觸發call <span class=\"token keyword\">function</span>\n<span class=\"token operator\">...</span>\n      <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">'name'</span> <span class=\"token operator\">:</span> name<span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">'phone'</span><span class=\"token operator\">:</span>phone<span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">'time'</span><span class=\"token operator\">:</span> filltime<span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">'order'</span><span class=\"token operator\">:</span> order<span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">'price'</span><span class=\"token operator\">:</span> price<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://script.google.com/macros/s/AKfycbz3fU3FVDmIQehtWX6ecKuV_A67lE64FEQ-ekmOZ_jZDyY96z0/exec\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> data<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">dataType</span><span class=\"token operator\">:</span> <span class=\"token string\">\"JSON\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'感謝您的訂購！！'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"鹹酥雞訂購 範例網頁\">鹹酥雞訂購 範例網頁</a></p>\n<p><a href=\"https://docs.google.com/spreadsheets/d/1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c/edit#gid=0\" title=\"鹹酥雞訂購 Excel\">鹹酥雞訂購 Excel</a></p>\n<p><a href=\"https://github.com/Ianpig/work/blob/master/googleform.md\" title=\"google form api html\">詳細的 code HTML Javasctipt + Appscript code</a></p>\n<p>剩下部份就客戶讀取、取消訂單，最後連結是進階處理。</p>\n<p>總結一下步驟:\n建立 excel、appscript -> 編輯 appscript -> 部署公開串接 -> 網頁前端串接 api ->>> over</p>\n<h2>使用心得</h2>\n<p>目前服務的公司也經常使用 google excel api，假設填表資料需要分享觀看、編輯，也不希望合作夥伴觀看公司後台，通常就會使用 google excel 來處理填表，優點就是創立非常快速、不需要後端幫忙，只要前端處理 css + html + javascript 大概 2 小時可以搞定。</p>\n<ul>\n<li>接續文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>\n<!--- ![炸雞demo](../images/炸雞demo.png \"炸雞demo\") --->\n","fields":{"readingTime":{"text":"8 min read"}},"frontmatter":{"title":"Google sheet 試算表表單串接api","date":"February 08, 2018","description":"要用到活動或是問卷，相信大家最常會用到google form，非常快速的創出填表功能，但google form存在許多限制，google analytics轉換目標也不能設定，都可以用google excel的api來解決。","categories":"javascript","tags":["google_form"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bf296d6e823a934526cab91eb6eaacae/83279/%E7%82%B8%E9%9B%9Edemo.png","srcSet":"/static/bf296d6e823a934526cab91eb6eaacae/e1b36/%E7%82%B8%E9%9B%9Edemo.png 200w,\n/static/bf296d6e823a934526cab91eb6eaacae/f4f52/%E7%82%B8%E9%9B%9Edemo.png 400w,\n/static/bf296d6e823a934526cab91eb6eaacae/83279/%E7%82%B8%E9%9B%9Edemo.png 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[{"srcSet":"/static/bf296d6e823a934526cab91eb6eaacae/908a7/%E7%82%B8%E9%9B%9Edemo.webp 200w,\n/static/bf296d6e823a934526cab91eb6eaacae/5aeb0/%E7%82%B8%E9%9B%9Edemo.webp 400w,\n/static/bf296d6e823a934526cab91eb6eaacae/f2384/%E7%82%B8%E9%9B%9Edemo.webp 800w","type":"image/webp","sizes":"(min-width: 800px) 800px, 100vw"}]},"width":1280,"height":742.4000000000001}}},"image":{"publicURL":"/static/bf296d6e823a934526cab91eb6eaacae/炸雞demo.png"}}},"previous":{"fields":{"slug":"/2018-01-whatseo/"},"frontmatter":{"title":"SEO優化 google教學guideline介紹"}},"next":{"fields":{"slug":"/2018-03-interview/"},"frontmatter":{"title":"前端工程師面試心得 | Frontend Engineer interview"}}},"pageContext":{"id":"c871f0be-23f9-50ed-a01a-4ca0dc585bcd","previousPostId":"451097c9-4a8b-5a8c-89cd-0403c9f86ed1","nextPostId":"34f9173d-9df8-57cc-952f-a7633d81dcd9"}},"staticQueryHashes":["3649515864","3761976949","441988385"]}